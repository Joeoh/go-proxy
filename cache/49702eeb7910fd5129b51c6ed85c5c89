HTTP/1.1 200 OK
Date: Mon, 20 Feb 2017 03:41:41 GMT
Server: Apache/2.4.25
Last-Modified: Tue, 31 Jan 2017 11:29:08 GMT
ETag: "19f9-547623d90d161"
Accept-Ranges: bytes
Content-Length: 6649
Connection: close
Content-Type: application/javascript

/*
TCD Header and Footer JavaScript
*/

// Add a class indicating JavaScript is enabled
if (/\bjs\b/gi.test((document.documentElement.className || '')) === false) {
	document.documentElement.className += ' js';
}

// Load Script Async
// http://gist.github.com/davesmiths/10277438
(function(c){var b=document.createElement("script"),a,d=[];b.type="text/javascript";b.async=true;a=function(i,j){var h,f,g=document.getElementsByTagName("script")[0],e;d[i]=d[i]||[];e=d[i].length;d[i][e]=j||function(){};if(e===0){h=b.cloneNode(true);h.onreadystatechange=h.onload=(function(k){return function(n){var m,l=d[k].length;if(!f&&(!this.readyState||this.readyState==="complete"||this.readyState==="loaded")){this.onreadystatechange=null;f=1;for(m=0;m<l;m++){d[k][m]()}d[k]=[]}}}(i));g.parentNode.insertBefore(h,g);h.src=i}};c["gist.github.com/davesmiths/10277438"]=a}(window));


// Web Font Loader handling
// If html.tcd-header-footer-webfontloader-off exists then do nothing
// If html.tcd-header-footer-webfontloader-config exists then do Web Font Loader config only
// Else defaults to Web Font Loader on
if (/\btcd-header-footer-webfontloader-off\b/gi.test((document.documentElement.className || '')) === false) {

	// Create a config object for Web Font Loader by Typekit and Google
	// https://github.com/typekit/webfontloader
	(function(context) {
		var wfc;
		wfc = context.WebFontConfig || {};
		wfc.google = wfc.google || {};
		wfc.google.families = wfc.google.families || [];
		wfc.google.families.push('Open+Sans:600');
		context.WebFontConfig = wfc;
	}(this));

	if (/\btcd-header-footer-webfontloader-config\b/gi.test((document.documentElement.className || '')) === false) {
		// Web Font Loader by Typekit and Google
		// https://github.com/typekit/webfontloader
		(function() {
			var wf = document.createElement('script');
			wf.src = ('https:' == document.location.protocol ? 'https' : 'http') +
			'://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js';
			wf.type = 'text/javascript';
			wf.async = 'true';
			var s = document.getElementsByTagName('script')[0];
			s.parentNode.insertBefore(wf, s);
		})();
	}
}

// Log JS errors with Google Analytics
// Added by Dave Smith 2014 September 12
// https://developer.mozilla.org/en-US/docs/Web/API/GlobalEventHandlers.onerror
// https://developers.google.com/analytics/devguides/collection/gajs/methods/gaJSApiEventTracking#_gat.GA_EventTracker_._trackEvent
// (function(context) {
//
//     'use strict';
//
// 	var saveTheOldOnError = window.onerror,
// 		loadScriptAsync = context['gist.github.com/davesmiths/10277438'],
// 		typeOf;
//
// 	typeOf = function(o) {
// 		return ({}).toString.call(o).match(/\s([a-zA-Z]+)/)[1].toLowerCase();
// 	};
//
// 	loadScriptAsync('//www.tcd.ie/assets/js/trinity-google-analytics/1/trinity-google-analytics.js', function() {
//
// 		if (typeOf(context.ga) === 'function') {
//
// 			// Override previous handler.
// 			window.onerror = function myErrorHandler(errorMsg, url, lineNumber) {
//
// 				if (saveTheOldOnError) {
// 					// Call previous handler.
// 					return saveTheOldOnError(errorMsg, url, lineNumber);
// 				}
//
//
// 				(function(errorMsg, url, lineNumber) {
// 					setTimeout(
// 						function() {
// 							context.ga('tcd.send',
// 								{
// 									'hitType': 'event',
// 									'eventCategory': 'TCDHeaderFooterJSErrorDetect',
// 									'eventAction': errorMsg + ', ' + lineNumber + ', ' + url,
// 									'eventLabel': window.location.href,
// 									'eventValue': 1,
// 									'nonInteraction': false
// 								}
// 							);
// 						},
// 						100
// 					);
// 				}(errorMsg, url, lineNumber));
//
// 				// Just let default handler run.
// 				return false;
//
// 			};
// 		}
//
// 	});
//
//
// }(this));


// Trinity Header Footer JS proper
(function(context) {

	var init,
	loadScriptAsync = context['gist.github.com/davesmiths/10277438'];

	init = function($) {

		// TCD Search Assist.
		//loadScriptAsync('//www.tcd.ie/tms/m/scripts/jquery/tcd-search-assist/tcd-search-assist-1.2.1.js');

		$(function() {

			var windowResizeHandlingOn = true,
			timeoutID;

			$('.tcd-header-toggles a').each(function() {
				var $a = $(this);
				$a.on('click', function() {

					var $a = $(this),
					href = $a.attr('href');

					windowResizeHandlingOn = false;
					clearTimeout(timeoutID);
					timeoutID = setTimeout(function() {
						windowResizeHandlingOn = true;
					}, 1000);

					$(href).slideToggle(0);

					if ($a.is('.tcd-header-toggle-search')) {
						$(href).find('input').eq(0).focus();
					}

					return false;
				});
			});
			$(window).on('resize.tcdheaderfooter', function() {
				if (windowResizeHandlingOn) {
					$('.tcd-header-panel').attr('style', '');
				}
			});
			$(document).on('keyup', function(e) {
				if (e.key == 'Esc') {
					// Close all, but need to create close and opening functions
				}
			});
		});

/*
		// TCD Header and Footer Actions.
		$(function() {
			// Core Tabs behaviour.
			// Adds a more button, which shows and hides items with the class more.
			var core_tabs = $('div.tcd-tabs');
			var more_link = $('a.tcd-tabs-more', core_tabs);
			more_menu = $('ul.tcd-tabs-more-menu').css({opacity:0}).remove();
			more_menu = core_tabs.append(more_menu.addClass('tcd-tabs-more-menu')).find('ul.tcd-tabs-more-menu');
			more_link
			.bind('open', function() {
				more_menu.addClass('tcd-tabs-more-menu-open').css({opacity:1});
				more_link.addClass('tcd-tabs-more-open');
			})
			.bind('close', function() {
				if (more_menu.hasClass('tcd-tabs-more-menu-closing') === false) {
					more_menu.addClass('tcd-tabs-more-menu-closing');
					more_menu.animate({opacity:0}, {duration:750, complete: function() {
						more_menu.removeClass('tcd-tabs-more-menu-open');
						more_link.removeClass('tcd-tabs-more-open');
						more_menu.removeClass('tcd-tabs-more-menu-closing');
					}});
				}
			});
			more_link.bind('click', function() {
				if (more_menu.hasClass('tcd-tabs-more-menu-open')) {
					more_link.trigger('close');
				}
				else {
					more_link.trigger('open');
				}
				return false;
			});
				// Click anywhere on the document to close the More Tabs.
			$(document).bind('click focusin keyup', function(e) {
				if ($(e.target).closest('div.tcd-tabs').length === 0 || e.which === 27) {
					more_link.trigger('close');
				}
			});
		});
*/
	};


	// jQuery dependency handling
	// If jQuery is already loaded use it
	if (typeof jQuery !== 'undefined') {
		init(jQuery);
	}
	else {
		loadScriptAsync('//code.jquery.com/jquery-1.11.2.min.js', function() {
			var jq = jQuery.noConflict(true);
			init(jq);
		});
	}

}(this));
